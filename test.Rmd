---
title: "EC4308 Project"
author: "Josiah Lee, Riley Teo, Steffi Lum"
date: "`r Sys.Date()`"
output: html_document
---



### Read in the Data
<!-- install.packages("devtools") -->
<!-- install_github(gabrielrvsc/HDeconometrics) -->

library(HDeconometrics)
library(conflicted)
library(readxl)
library(tidyverse)
library(dplyr)
library(ggplot2)
library(tsibble)
library(purrr)
library(tseries)
library(car)
library(leaps)
library(tictoc)

source("01-eda.R")

### Doing the model 

# Starting of with best subset selection, we select the model with the lowest AIC
tic()
bssel = regsubsets(ep~.-yyyymm, data = train, nvmax = 21, method = "exhaustive")
toc()

sumbss = summary(bssel)

plot(bssel, scale = "bic")

# We use full model to estimate var as 496/
ntrain = 496
varest=sumbss$rss[21]/(ntrain-22) #estimate error variance of the model with k=21


#construct the IC with this estimate (note seq() used to generate a sequence from 1 to 11 regressors to plug into the formula):
BICL = sumbss$rss/ntrain + log(ntrain)*varest*((seq(1,11,1))/ntrain)
AICL = sumbss$rss/ntrain + 2*varest*((seq(1,11,1))/ntrain)

kbicl=which.min(BICL) #BIC choice

kaicl=which.min(AICL)  #AIC choice (AIC proportional to Cp and so ranking is the same)

sig0=var(train$ep) #sample variance of Y
#Compute IC for the models using sigma0 estimate:
BIC0 = sumbss$rss/ntrain + log(ntrain)*sig0*((seq(1,11,1))/ntrain)
AIC0 = sumbss$rss/ntrain + 2*sig0*((seq(1,11,1))/ntrain)

#Select best models
k0bic = which.min(BIC0)
k0aic = which.min(AIC0)



### Model


### CV
MSE <- function(pred, truth){ #start and end body of the function by { } - same as a loop 
  return(mean((truth - pred)^2)) #end function with a return(output) statement. Here we can go straight to return because the object of interest is a simple function of inputs
}


### Evaluation


### Portfolio Strategy

